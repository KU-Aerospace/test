%-------------------------------------------------------------------------
% Legdre polynomial and its derivative
%-------------------------------------------------------------------------
function [fL,dfL] = L1_Legendre_Poly(N,tau)
%-------------------------------------------------------------------------
   if N==0 
       fL= 1.0  ;
   elseif N == 1 
       fL = tau ; dfL = 1.0 ;
   else
       fL_vec(1) = 1.0  ;  
       fL_vec(2) = tau  ;  
%
       for j=2:N+1
           jm  = j-1 ; c1 = (2.0*j-1)/j ;
           jp  = j+1 ; c2 = (1.0*j-1)/j ;
           fL_vec(jp) =  c1*fL_vec(j)*tau - c2*fL_vec(jm) ;
       end
       fL  = fL_vec(N+1)                                     ;
       dfL = (fL_vec(N) - fL_vec(N+2) )/(1.0-tau^2)      ; 
       dfL = dfL*N*(N+1)/(2*N+1)                           ;
   end;
%-------------------------------------------------------------------------
end   
%-------------------------------------------------------------------------
