%-------------------------------------------------------------------------
% Polynomial Deflation for the n-th order polynomial
% y = a(1,1)+a(2,1)*x + a(3,1)*x^2 + .... + a(n+1,1)*x^n
%   = (x^2+q1*x+q0)*[b(1,1)+b(2,1)*x + b(3,1)*x^2 +....+ b(n-1,1)*x^(n-2)]
%-------------------------------------------------------------------------
function [b,r]=polynomial_deflation2(n,a,q1,q0)
b(n-1,1) = a(n+1,1);
b(n-2,1) = a(n,1) - q1*b(n-1,1);
for j= n-3:-1:1
    b(j,1) = a(j+2,1) - q1*b(j+1,1)-q0*b(j+2,1);
end
r(2,1) = a(2,1) - q1*b(1,1)-q0*b(2,1);
r(1,1) = a(1,1) - q0*b(1,1);
%-------------------------------------------------------------------------
% Example Test #1 y=x^3-1 = (x^2+x+1)(x-1)
%    clear all;n=3;a(1:4,1) = 0.0;a(4,1)=1.0;a(1,1)=-1.0;q1=1;q0=1;[b,r]=polynomial_deflation2(n,a,q1,q0)
%    answer: b =(-1,1)^T,  r=(0,0)^T 
%-------------------------------------------------------------------------
% Example Test #2 y=x^4+x^2+1 = (x^2+x+1)(x^2-x+1)
%    clear all;n=4;a(1:5,1) = 0.0;a(5,1)=1.0;a(3,1)=1.0;a(1,1)= 1.0;q1=1;q0=1;[b,r]=polynomial_deflation2(n,a,q1,q0)
%    answer: b =(1,-1,1)^T,  r=(0,0)^T 
%-------------------------------------------------------------------------
% Example Test #3 y=x^6-1 = (x^3-1)(x^3+1)= (x^2+x+1)(x-1)(x^3+1)=(x^2+x+1)(x^4-x^3+x-1)
%    clear all;n=6;a(1:7,1) = 0.0;a(7,1)=1.0;a(1,1)=-1.0;q1=1;q0=1;[b,r]=polynomial_deflation2(n,a,q1,q0)
%    answer: b =(-1,1,0,-1,1)^T,  r=(0,0)^T 
%-------------------------------------------------------------------------